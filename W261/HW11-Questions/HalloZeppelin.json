{"paragraphs":[{"text":"val y = sc.textFile(\"hdfs://localhost:9000/user/leiyang/PageRank-test.txt\")\n//y.collect()","dateUpdated":"Mar 30, 2016 11:31:37 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":false,"editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459393628318_-1374288508","id":"20160330-230708_1258987653","result":{"code":"SUCCESS","type":"TEXT","msg":"y: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[64] at textFile at <console>:32\n"},"dateCreated":"Mar 30, 2016 11:07:08 PM","dateStarted":"Mar 30, 2016 11:31:37 PM","dateFinished":"Mar 30, 2016 11:31:37 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:50"},{"text":"%md\n\n### test1","dateUpdated":"Mar 30, 2016 11:39:39 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459393764769_-1074417518","id":"20160330-230924_169923529","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>test1</h3>\n"},"dateCreated":"Mar 30, 2016 11:09:24 PM","dateStarted":"Mar 30, 2016 11:22:27 PM","dateFinished":"Mar 30, 2016 11:22:27 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:51"},{"text":"%pyspark\n\ny=sc.textFile(\"hdfs://localhost:9000/user/leiyang/PageRank-test.txt\")\n\nprint y.count()\nprint y.collect()\n","dateUpdated":"Mar 30, 2016 11:41:45 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":false,"title":false,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459394284547_1654187745","id":"20160330-231804_1856259094","result":{"code":"SUCCESS","type":"TEXT","msg":"10\n[u\"B\\t{'C': 1}\", u\"C\\t{'B': 1}\", u\"D\\t{'A': 1, 'B': 1}\", u\"E\\t{'D': 1, 'B': 1, 'F': 1}\", u\"F\\t{'B': 1, 'E': 1}\", u\"G\\t{'B': 1, 'E': 1}\", u\"H\\t{'B': 1, 'E': 1}\", u\"I\\t{'B': 1, 'E': 1}\", u\"J\\t{'E': 1}\", u\"K\\t{'E': 1}\"]\n"},"dateCreated":"Mar 30, 2016 11:18:04 PM","dateStarted":"Mar 30, 2016 11:41:45 PM","dateFinished":"Mar 30, 2016 11:41:45 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:52"},{"text":"%sh\n#hdfs dfs -ls\n#/usr/local/Cellar/hadoop/2*/sbin/stop-dfs.sh\n/usr/local/Cellar/hadoop/2*/sbin/start-dfs.sh","dateUpdated":"Mar 30, 2016 11:46:30 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorHide":false,"tableHide":false,"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459394426013_-1769491859","id":"20160330-232026_1987131858","result":{"code":"SUCCESS","type":"TEXT","msg":"Starting namenodes on [localhost]\nlocalhost: namenode running as process 12003. Stop it first.\nlocalhost: datanode running as process 12097. Stop it first.\nStarting secondary namenodes [0.0.0.0]\n0.0.0.0: secondarynamenode running as process 12216. Stop it first.\n"},"dateCreated":"Mar 30, 2016 11:20:26 PM","dateStarted":"Mar 30, 2016 11:46:12 PM","dateFinished":"Mar 30, 2016 11:46:16 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53"},{"text":"%pyspark\n\nfrom time import time\nfrom datetime import datetime\n\ndef initialize(line):          \n    # parse line\n    nid, adj = line.strip().split('\\t', 1)     \n    exec 'adj = %s' %adj\n    # initialize node struct        \n    node = {'a':adj.keys(), 'p':0}\n    rankMass = 1.0/len(adj)    \n    # emit pageRank mass and node    \n    return [(m, rankMass) for m in node['a']] + [(nid.strip('\"'), node)]\n\ndef accumulateMass(a, b):\n    if isinstance(a, float) and isinstance(b, float):\n        return a+b\n    if isinstance(a, float) and not isinstance(b, float):\n        b['p'] += a\n        return b\n    else:\n        a['p'] += b\n        return a\n    \ndef getDangling(node):    \n    global nDangling\n    if isinstance(node[1], float):\n        nDangling += 1\n        return (node[0], {'a':[], 'p':node[1]})\n    else:\n        return node\n    \ndef redistributeMass(node):\n    node[1]['p'] = (p_dangling+node[1]['p'])*damping + alpha\n    return node\n    \ndef distributeMass(node):    \n    global lossMass\n    mass, adj = node[1]['p'], node[1]['a']\n    node[1]['p'] = 0\n    if len(adj) == 0:\n        lossMass += mass\n        return [node]\n    else:\n        rankMass = mass/len(adj)\n        return [(x, rankMass) for x in adj]+[node]\n\ndef logTime():\n    return str(datetime.now())\n\n","dateUpdated":"Mar 30, 2016 11:44:25 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459395239252_-997757252","id":"20160330-233359_264207247","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Mar 30, 2016 11:33:59 PM","dateStarted":"Mar 30, 2016 11:44:25 PM","dateFinished":"Mar 30, 2016 11:44:25 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:54"},{"text":"%pyspark\n\nfrom operator import add\n\nnDangling = sc.accumulator(0)\nlossMass = sc.accumulator(0.0)\nG = p_dangling = 0\ndamping = 0.85\nalpha = 1 - damping\nnTop, nIter = 100, 10\nstart = time()\nprint '%s: start PageRank initialization ...' %(logTime())\ngraph = y.flatMap(initialize).reduceByKey(accumulateMass).map(getDangling).cache()\nG = graph.count()\np_dangling = 1.0*nDangling.value/G\ngraph = graph.map(redistributeMass)\n#graph.cache()\nprint '%s: initialization completed, dangling node(s): %d, total nodes: %d' %(logTime(), nDangling.value, G)\n\nfor i in range(nIter-1):\n    print '%s: running iteration %d ...' %(logTime(), i+2)\n    lossMass.value = 0.0\n    graph = graph.flatMap(distributeMass).reduceByKey(accumulateMass).cache() #checkpoint()?\n    # need to call an action here in order to have loss mass\n    graph.count()    \n    p_dangling = lossMass.value/G\n    print '%s: redistributing loss mass: %.4f' %(logTime(), lossMass.value)\n    graph = graph.map(redistributeMass)\n\ntotalMass = graph.aggregate(0, (lambda x, y: y[1]['p'] + x), (lambda x, y: x+y))\nprint '%s: normalized weight of the graph: %.4f' %(logTime(), totalMass/G)\nprint '%s: PageRanking completed in %.2f minutes, top %d are:' %(logTime(), (time()-start)/60.0, nTop)\nprint graph.map(lambda n:(n[0],n[1]['p']/G)).sortBy(lambda n: n[1], ascending=False).take(nTop)\n\n","dateUpdated":"Mar 30, 2016 11:45:33 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459395865842_-1046127821","id":"20160330-234425_1652642476","result":{"code":"SUCCESS","type":"TEXT","msg":"2016-03-30 23:45:33.834491: start PageRank initialization ...\n2016-03-30 23:45:33.903108: initialization completed, dangling node(s): 1, total nodes: 11\n2016-03-30 23:45:33.903141: running iteration 2 ...\n2016-03-30 23:45:33.974532: redistributing loss mass: 0.6523\n2016-03-30 23:45:33.974681: running iteration 3 ...\n2016-03-30 23:45:34.034759: redistributing loss mass: 0.4174\n2016-03-30 23:45:34.034802: running iteration 4 ...\n2016-03-30 23:45:34.092838: redistributing loss mass: 0.7042\n2016-03-30 23:45:34.092889: running iteration 5 ...\n2016-03-30 23:45:34.162608: redistributing loss mass: 0.4136\n2016-03-30 23:45:34.162656: running iteration 6 ...\n2016-03-30 23:45:34.225011: redistributing loss mass: 0.4254\n2016-03-30 23:45:34.225058: running iteration 7 ...\n2016-03-30 23:45:34.288391: redistributing loss mass: 0.3753\n2016-03-30 23:45:34.288438: running iteration 8 ...\n2016-03-30 23:45:34.361215: redistributing loss mass: 0.3812\n2016-03-30 23:45:34.361276: running iteration 9 ...\n2016-03-30 23:45:34.432925: redistributing loss mass: 0.3659\n2016-03-30 23:45:34.432979: running iteration 10 ...\n2016-03-30 23:45:34.495879: redistributing loss mass: 0.3660\n2016-03-30 23:45:34.518155: normalized weight of the graph: 1.0000\n2016-03-30 23:45:34.518186: PageRanking completed in 0.01 minutes, top 100 are:\n[('B', 0.3632359489889102), ('C', 0.36288372803871793), (u'E', 0.08114525762548769), ('D', 0.03938466342002967), ('F', 0.03938466342002967), ('A', 0.03293010178620472), (u'G', 0.016207127344124005), (u'I', 0.016207127344124005), (u'K', 0.016207127344124005), (u'H', 0.016207127344124005), (u'J', 0.016207127344124005)]\n"},"dateCreated":"Mar 30, 2016 11:44:25 PM","dateStarted":"Mar 30, 2016 11:45:33 PM","dateFinished":"Mar 30, 2016 11:45:34 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:55"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459395918390_-2140476286","id":"20160330-234518_1369136338","dateCreated":"Mar 30, 2016 11:45:18 PM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:56"}],"name":"HalloZeppelin","id":"2BF72M9GE","angularObjects":{"2BEGWVP62":[],"2BGMJY3G4":[],"2BFXQSFAZ":[],"2BJ5WMTYQ":[],"2BG6MJGUE":[],"2BH37RB8E":[],"2BGAJ5FMN":[],"2BF2GH4C2":[],"2BF87DX4C":[],"2BEPN2DG4":[],"2BJ328RQ6":[],"2BHQ4567J":[],"2BF459WUH":[],"2BFP2HNHT":[]},"config":{"looknfeel":"default"},"info":{}}